<!DOCTYPE html>
<html>
  <header>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <style>
      #map {
        height: 500px;
        background: pink;
      }
    </style>
  </header>
  <body>
    <div id="map"></div>

    <script>
      let st = [
        "bakerloo", 
        "circle", 
        "central", 
        "district", 
        "hammersmith-city",
        "jubilee",
        "metropolitan",
        "northern",
        "piccadilly",
        "victoria",
        "waterloo-city"
      ]
      let col = {
        "bakerloo": "red", 
        "circle": "yellow", 
        "central": "green",
        "district": "blue",
        "hammersmith-city": "purple",
        "jubilee": "orange",
        "metropolitan": "white",
        "northern": "beige",
        "piccadilly": "pink",
        "victoria": "grey",
        "waterloo-city": "darkred"

      }
      var map = L.map("map").setView([51.505, -0.09], 12);

      L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: "Â© OpenStreetMap",
      }).addTo(map);

      fetch('https://api.tfl.gov.uk/Line/Mode/tube/Route', {
        method: 'GET',
        // Request headers
        headers: {
            'Cache-Control': 'no-cache',}
    })
    .then(response => {
        console.log(response.status);

        response.json().then(re => {
          console.log(re)
        })

        //console.log(response.json());
    })
    .catch(err => console.error(err));

    //var marker = L.marker([51.5, -0.09]).addTo(map);

    st.forEach(stationName=>{

      fetch('https://api.tfl.gov.uk/Line/' + stationName + '/StopPoints', {
        method: 'GET',
        // Request headers
        headers: {
            'Cache-Control': 'no-cache',}
    })
    .then(response => {
        console.log(response.status);

        response.json().then(data=>{
          data.forEach(t=>{

            var circle = L.circle([t["lat"], t["lon"]], {
              color: col[stationName],
              fillColor: '#f03',
              fillOpacity: 0.5,
              radius: 50
          }).addTo(map);

            //L.marker([t["lat"], t["lon"]]).addTo(map)
          })
        })

        console.log(response.text());
    })
    .catch(err => console.error(err));

    })
    
    

      //addKolumbusVehiclesToMap(map);
    </script>
  </body>
</html>
